# æœåŠ¡åç§°æ˜ å°„è¡¨

> **ç‰ˆæœ¬**: v1.0 | **æœ€åæ›´æ–°**: 2025-11-10 | **ç»´æŠ¤è€…**: è¿ç»´è´Ÿè´£äºº | **çŠ¶æ€**: æ´»è·ƒ
>
> ğŸ” **ç”¨é€”**: ç»Ÿä¸€ Docker Compose / Kubernetes / ä»£ç ä¸­çš„æœåŠ¡å‘½å

## Docker Compose æœåŠ¡åï¼ˆå®˜æ–¹æ ‡å‡†ï¼‰
åŸºäº `docker-compose.local-images.yml` çš„å®šä¹‰ï¼š

| æœåŠ¡å | æè¿° | å†…éƒ¨ç«¯å£ | å¤–éƒ¨ç«¯å£ | å¤‡æ³¨ |
|--------|------|----------|----------|------|
| `postgres` | PostgreSQLæ•°æ®åº“ | 5432 | 5432 | åŸºç¡€è®¾æ–½ |
| `redis` | Redisç¼“å­˜ | 6379 | 6379 | åŸºç¡€è®¾æ–½ |
| `rabbitmq` | RabbitMQæ¶ˆæ¯é˜Ÿåˆ— | 5672/15672 | 5672/15672 | åŸºç¡€è®¾æ–½ |
| `eureka` | æœåŠ¡æ³¨å†Œä¸­å¿ƒ | 8761 | 8761 | å¾®æœåŠ¡æ ¸å¿ƒ |
| `config` | é…ç½®æœåŠ¡å™¨ | 8888 | 8888 | å¾®æœåŠ¡æ ¸å¿ƒ |
| `gateway` | APIç½‘å…³ | 8080 | 8080 | **æ ¸å¿ƒè·¯ç”±** |
| `auth` | è®¤è¯æœåŠ¡ | 8081 | 8081 | ç”¨æˆ·è®¤è¯ |
| `station` | ç«™ç‚¹ç®¡ç†æœåŠ¡ | 8082 | 8082 | ä¸šåŠ¡æœåŠ¡ |
| `tenant` | ç§Ÿæˆ·ç®¡ç†æœåŠ¡ | 8083 | 8083 | ä¸šåŠ¡æœåŠ¡ |
| `order` | è®¢å•æœåŠ¡ | 8084 | 8084 | ä¸šåŠ¡æœåŠ¡ |
| `payment` | æ”¯ä»˜æœåŠ¡ | 8085 | 8085 | ä¸šåŠ¡æœåŠ¡ |
| `protocol` | åè®®å¤„ç†æœåŠ¡ | 8086 | 8086 | åè®®æ”¯æŒ |
| `monitoring` | ç›‘æ§æœåŠ¡ | 9090 | 9090 | ç³»ç»Ÿç›‘æ§ |
| `admin` | å‰ç«¯ç®¡ç†ç•Œé¢ | 80 | 80 | Webç•Œé¢ |

## é¡¹ç›®ä¸­å­˜åœ¨çš„å…¶ä»–æœåŠ¡

| æœåŠ¡å | æè¿° | çŠ¶æ€ | å¤‡æ³¨ |
|--------|------|------|------|
| `evcs-integration` | ç¬¬ä¸‰æ–¹é›†æˆæœåŠ¡ | å¼€å‘ä¸­ | å¤–éƒ¨ç³»ç»Ÿå¯¹æ¥ |
| `evcs-common` | å…¬å…±ç»„ä»¶åº“ | æ ¸å¿ƒä¾èµ– | JWTã€Redisã€å·¥å…·ç±» |
| `evcs-gateway-backup` | ç½‘å…³å¤‡ä»½æœåŠ¡ | å¤‡ç”¨ | é«˜å¯ç”¨æ–¹æ¡ˆ |
| `evcs-web` | WebæœåŠ¡ | ç©ºç›®å½• | é¢„ç•™æ‰©å±• |

## æœåŠ¡åä½¿ç”¨è§„åˆ™

### âœ… æ­£ç¡®ç”¨æ³•
- Nginxé…ç½®: `proxy_pass http://gateway:8080/`
- Springé…ç½®: `uri: lb://auth`
- æœåŠ¡è°ƒç”¨: `http://tenant:8083/api`

### âŒ é”™è¯¯ç”¨æ³•
- `gateway-service` â†’ åº”è¯¥æ˜¯ `gateway`
- `evcs-auth` â†’ åº”è¯¥æ˜¯ `auth`
- `tenant-service` â†’ åº”è¯¥æ˜¯ `tenant`

## é…ç½®æ–‡ä»¶æ£€æŸ¥è¦ç‚¹

1. **docker-compose.yml** - æœåŠ¡åå®šä¹‰çš„æƒå¨æ¥æº
2. **nginx.conf** - proxy_passä¸­çš„æœåŠ¡åå¿…é¡»ä¸docker-composeä¸€è‡´
3. **Config Serveré…ç½®** - lb://åé¢çš„æœåŠ¡å
4. **application.yml** - Eurekaæ³¨å†Œå’Œå‘ç°çš„æœåŠ¡å

## ç«¯å£æ˜ å°„è¡¨

| æœåŠ¡ | å†…éƒ¨ç«¯å£ | å¤–éƒ¨ç«¯å£ | è¯´æ˜ |
|------|----------|----------|------|
| gateway | 8080 | 8080 | APIç½‘å…³ |
| auth | 8081 | 8081 | è®¤è¯æœåŠ¡ |
| station | 8082 | 8082 | ç«™ç‚¹æœåŠ¡ |
| tenant | 8083 | 8083 | ç§Ÿæˆ·æœåŠ¡ |
| order | 8084 | 8084 | è®¢å•æœåŠ¡ |
| payment | 8085 | 8085 | æ”¯ä»˜æœåŠ¡ |
| protocol | 8086 | 8086 | åè®®æœåŠ¡ |
| monitoring | 9090 | 9090 | ç›‘æ§æœåŠ¡ |
| eureka | 8761 | 8761 | æœåŠ¡æ³¨å†Œä¸­å¿ƒ |
| config | 8888 | 8888 | é…ç½®ä¸­å¿ƒ |
| admin | 80 | 80 | å‰ç«¯ç•Œé¢ |
| postgres | 5432 | 5432 | æ•°æ®åº“ |
| redis | 6379 | 6379 | ç¼“å­˜ |
| rabbitmq | 5672/15672 | 5672/15672 | æ¶ˆæ¯é˜Ÿåˆ—/ç®¡ç†ç•Œé¢ |

**é‡è¦**: å†…éƒ¨æœåŠ¡é—´é€šä¿¡ä½¿ç”¨å†…éƒ¨ç«¯å£ï¼Œå¤–éƒ¨è®¿é—®ä½¿ç”¨æ˜ å°„ç«¯å£ã€‚
